# Brandmeister talkgroup search and converter tool for AnyTone radios

Currently supported radios are:

- AT-868
- AT-878 (tested)

## What it does

It allows you to:

- list and search Brandmeister talkgroups by country, name or ID
- generate talk groups CSV files that you can import directly to your AnyTone radio

## What you need

The list of talk groups on Brandmeister in CSV format.

- Go to https://brandmeister.network/?page=talkgroups
- Select `Show "ALL" entries`
- Click the CSV button

Tip:

- The file name contains a lot of unecessary white spaces, I suggest to remove them entirely or to rename the file.
- The default file name expected by the cli is `TalkgroupsBrandMeister.csv`

### Installation

I highly recomment you create a virtual environment and then install the cli.

Clone the repository.

In your destination directory:

```
python3 -m venv .env
source .env/bin/activate
```

Install the requirements:

```
pip install --editable .
```

You can now run the cli: `anytone --help`

### Usage:

#### Help

General help: `anytone --help`
Command help: `anytone <command> --help` (e.g.: anytone find --help)

Note: 

- The brandmeister CSV file provided (TalkgroupsBrandMeister.csv) has been exported 13 july 2019. Use it for testing only and get a current CSV export from Brandmeister if you want fresh data.
- Search is case insensitive.

#### Find talkgroups

The Brandmeister CSV file can be queried by:

- country: the exact international 2 letter abreviation, e.g. us, fr, de, gb
- name: partial or complete talkgroup name
- tgid: the exact talkgroup ID

Examples:

```
$ anytone find -t  310                         
--------|-----------|------------------------------
Country | Talkgroup | Name
---------------------------------------------------
US      |    310    | Tactical 310 - DMRX - NO Camping or Parking on this Talkgroup!!!
---------------------------------------------------

$ anytone find -n saarland                  
--------|-----------|------------------------------
Country | Talkgroup | Name
---------------------------------------------------
DE      |    2625   | Rheinland-Pfalz/Saarland
DE      |   26250   | Saarland
---------------------------------------------------

$ anytone find -c fr      
--------|-----------|------------------------------
Country | Talkgroup | Name
---------------------------------------------------
FR      |    208    | France
FR      |    2080   | Urgences FR
FR      |    2081   | Région Ile de France
FR      |    2082   | Région Nord-ouest
FR      |    2083   | Région Nord-est
FR      |    2084   | Région Sud-est
FR      |    2085   | Région Sud-ouest
[...]
---------------------------------------------------

$ anytone find -c global -n parrot -t 9990
--------|-----------|------------------------------
Country | Talkgroup | Name
---------------------------------------------------
Global  |    9990   | Parrot
---------------------------------------------------
```

`find` can be used to search and narrow down what filters will be used to generate a CSV file with the desired talgroups that will be imported to the radio.

#### Generate AT talkgroups

Once you have found the talkgroups you would like to extract from the Brandmeister CSV file into a AnyTone compatible CSV file, you can re-use your search criteria and create search filters.

Search filters can be tried out on the command line, but I recommend creating a yaml file containing all desired filters.

On the command line, you can pass a string as a list of dictionaries (containing the filters).

```
$ anytone generate -f '{"country": "fr"}, {"tgId": "9990"}' 
```

Note: If no output file is indicated, the CSV file generated will be named `Anytone-TGs.csv`

It is highly recommended to use a yaml file to list filters.

Save this example to myFilters.yaml:

```
# TGs from France where name contains 'est'
- country: "fr"
  name: "est"
# All TGs for Germany
- country: "de"
# TG for golbal where name contains parrot and talkgroup number equals 9990
- country: "global"
  name: "parrot"
  tgid: "9990"
# TGs containing the name scotland
- name: "scotland"
# TG where ID equals 302 (Canada)
- tgId: "302"
```

Then use the filters file and generate your personalized takgroups file:

```
$ anytone generate -i myFilters.yaml
```

A file named `Anytone-TGs.csv` is generated by default if no output file is given.

```
$ anytone generate -i myFilters.yaml myTalkGroupList.csv
```

A file name `myTalkGroupList.csv` is generated.

#### DMR user database

Download the DMR user database from [radioid.net](http://radioid.net).

```
anytone users
```

This will generate a file named Users.CSV ready to be uploaded to your radio.